{% extends 'layouts/base_tool.html' %}
{% load bootstrap3 %}

{% block title %}
	Edit Simulation {{ model.name }}
{% endblock %}

{% block additionalcss %}{% endblock %}

{% block content %}
	<br><br>
		{% for error in errors %}
			{{ error }}<br>
		{% endfor %}
	<br><br>

	
	<h1>2 - Specify the attribute- and entity- types</h1>
	<form role="form" action="" method="post" class="form">
		{% csrf_token %}
		<div class="form-group has-error">
			<label class="control-label" for="id_name">Name</label>
			<input type="text" name="name" maxlength="255" class="form-control" placeholder="Name" title="" required id="id_name" />
			<div class="help-block">This field is required.</div>
		</div>
		<div class="form-group has-error">
			<label class="control-label" for="id_content_specification">Content specification</label>
			<textarea name="content_specification" cols="40" rows="10" class="form-control" placeholder="Content specification" title="" required id="id_content_specification">{{ uploaded_dataset.content_specification }}</textarea>
			<div class="help-block">This field is required.</div>
		</div>
		<div class="form-group">
			<button type="submit" class="btn btn-primary">
				<span class="glyphicon glyphicon-star"></span> Next
			</button>
		</div>
	</form>	
	<br>
	<br>
	<p id="uploaded_table"></p>

<script>
    function CreateTableFromJSON() {
	
		var content_specification = {{ uploaded_dataset.content_specification | safe }}
        var myTable = content_specification["data"]
		
		 // CREATE DYNAMIC TABLE.
        var table = document.createElement("table");
	
		// GET HEADER VALUES
		var column_headers = Object.keys(myTable)
		
		// MAKE TABLE HEADER
		var tr = table.insertRow(-1);                   // TABLE ROW.

        for (var i = 0; i < column_headers.length; i++) {
            var th = document.createElement("th");      // TABLE HEADER.
            th.innerHTML = column_headers[i];
            tr.appendChild(th);
        }
		
		// MAKE TABLE ROWS
		for (var i = 0; i < myTable[column_headers[0]].length; i++) {
            tr = table.insertRow(-1);

            for (var j = 0; j < column_headers.length; j++) {
                var tabCell = tr.insertCell(-1);
                tabCell.innerHTML = myTable[column_headers[j]][i];
            }
        }

        // FINALLY ADD THE NEWLY CREATED TABLE WITH JSON DATA TO A CONTAINER.
        var divContainer = document.getElementById("uploaded_table");
        divContainer.innerHTML = "";
        divContainer.appendChild(table);
    }

	window.onload = function() {
	  CreateTableFromJSON();
	};
</script>
	
{% endblock %}
